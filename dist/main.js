(()=>{"use strict";var e,t,n,r,a={371:(e,t,n)=>{n.r(t),n.d(t,{default:()=>O});const r={create:function(e,t){const n=document.createElement(e);for(const[e,r]of Object.entries(t))n[e]=r;return n},appendAll:function(e,t){t.forEach((t=>e.appendChild(t)))},deleteAppContent:function(){document.getElementById("app").replaceChildren("")},getHeader:function(e){const t=document.createElement("header");t.classList.add("header",`${e}`);const n=document.createElement("h1");return n.textContent="Battleship",t.appendChild(n),t},createMap:function(e){const t=document.createElement("div");t.id=`board-${e}`,t.classList.add("board",e);const n=document.createElement("div");return n.className="board-corner",t.appendChild(n),t.appendChild(function(){const e=document.createElement("div");return e.classList="letter-container",["A","B","C","D","E","F","G","H","I","J"].forEach((t=>{const n=document.createElement("div");n.className="letter",n.textContent=t,e.appendChild(n)})),e}()),t.appendChild(function(){const e=document.createElement("div");return e.id="number-container",e.classList="number-container",[1,2,3,4,5,6,7,8,9,10].forEach((t=>{const n=document.createElement("div");n.classList="number",n.textContent=t,e.appendChild(n)})),e}()),t.appendChild(function(e){const t=document.createElement("div");t.id=`field-container-${e}`,t.className="field-container";for(let e=0;e<10;e+=1)for(let n=0;n<10;n+=1){const r=document.createElement("div");r.className="field",r.dataset.row=e,r.dataset.col=n,t.appendChild(r)}return t}(e)),t},getCoordinatesFromIndex:function(e){return{row:parseInt(e/10,10),col:e%10}},getIndexFromCoordinates:function({row:e,col:t}){return 10*e+t},roundNearestTenExceptZero:function(e){for(;e%10!=0;)e+=1;return e}},a=36,i={Carrier:(e,t)=>`\n        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${e} ${t}" width="${e}" height="${t}">\n            \x3c!-- Hull --\x3e\n            <rect x="2" y="4" width="${e-4}" height="${t-8}" rx="6" ry="6" fill="#4a4a4a" stroke="#333" stroke-width="1.5"/>\n            \x3c!-- Flight deck --\x3e\n            <rect x="6" y="8" width="${e-12}" height="${t-16}" rx="3" fill="#5a5a5a"/>\n            \x3c!-- Deck lines --\x3e\n            <line x1="12" y1="${t/2}" x2="${e-12}" y2="${t/2}" stroke="#777" stroke-width="0.8" stroke-dasharray="4,3"/>\n            <line x1="12" y1="${t/2-5}" x2="${e-12}" y2="${t/2-5}" stroke="#666" stroke-width="0.5" stroke-dasharray="3,4"/>\n            <line x1="12" y1="${t/2+5}" x2="${e-12}" y2="${t/2+5}" stroke="#666" stroke-width="0.5" stroke-dasharray="3,4"/>\n            \x3c!-- Island (control tower) --\x3e\n            <rect x="${e-50}" y="6" width="16" height="10" rx="2" fill="#3a3a3a" stroke="#222" stroke-width="1"/>\n            <rect x="${e-48}" y="3" width="4" height="3" rx="1" fill="#333"/>\n            \x3c!-- Bow arrow --\x3e\n            <polygon points="${e-8},${t/2} ${e-16},${t/2-4} ${e-16},${t/2+4}" fill="#666"/>\n            \x3c!-- Aircraft silhouettes on deck --\x3e\n            <g fill="#6a6a6a" opacity="0.6">\n                <rect x="14" y="${t/2-6}" width="10" height="4" rx="1"/>\n                <rect x="30" y="${t/2+2}" width="10" height="4" rx="1"/>\n                <rect x="50" y="${t/2-6}" width="10" height="4" rx="1"/>\n                <rect x="70" y="${t/2+2}" width="10" height="4" rx="1"/>\n            </g>\n        </svg>`,Battleship:(e,t)=>`\n        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${e} ${t}" width="${e}" height="${t}">\n            \x3c!-- Hull --\x3e\n            <path d="M 8,${t/2} Q 2,${t/2} 4,${t/2-8} L 10,${t/2-10} L ${e-10},${t/2-10} Q ${e-2},${t/2-8} ${e-2},${t/2} Q ${e-2},${t/2+8} ${e-10},${t/2+10} L 10,${t/2+10} Q 2,${t/2+8} 4,${t/2+8} Z" fill="#5a6a7a" stroke="#3a4a5a" stroke-width="1.5"/>\n            \x3c!-- Superstructure --\x3e\n            <rect x="${e/2-18}" y="${t/2-7}" width="36" height="14" rx="3" fill="#4a5a6a" stroke="#3a4a5a" stroke-width="1"/>\n            \x3c!-- Bridge --\x3e\n            <rect x="${e/2-8}" y="${t/2-9}" width="16" height="18" rx="2" fill="#3a4a5a"/>\n            \x3c!-- Forward turrets --\x3e\n            <circle cx="24" cy="${t/2}" r="6" fill="#4a5a6a" stroke="#3a4a5a" stroke-width="1"/>\n            <line x1="24" y1="${t/2}" x2="12" y2="${t/2}" stroke="#3a4a5a" stroke-width="2.5" stroke-linecap="round"/>\n            <circle cx="${e/2-26}" cy="${t/2}" r="5" fill="#4a5a6a" stroke="#3a4a5a" stroke-width="1"/>\n            <line x1="${e/2-26}" y1="${t/2}" x2="${e/2-38}" y2="${t/2}" stroke="#3a4a5a" stroke-width="2" stroke-linecap="round"/>\n            \x3c!-- Aft turrets --\x3e\n            <circle cx="${e-24}" cy="${t/2}" r="6" fill="#4a5a6a" stroke="#3a4a5a" stroke-width="1"/>\n            <line x1="${e-24}" y1="${t/2}" x2="${e-12}" y2="${t/2}" stroke="#3a4a5a" stroke-width="2.5" stroke-linecap="round"/>\n            \x3c!-- Bow --\x3e\n            <polygon points="4,${t/2} 10,${t/2-6} 10,${t/2+6}" fill="#5a6a7a" stroke="#3a4a5a" stroke-width="0.5"/>\n        </svg>`,Destroyer:(e,t)=>`\n        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${e} ${t}" width="${e}" height="${t}">\n            \x3c!-- Hull - sleek --\x3e\n            <path d="M 4,${t/2} L 10,${t/2-8} L ${e-8},${t/2-8} Q ${e-2},${t/2-4} ${e-2},${t/2} Q ${e-2},${t/2+4} ${e-8},${t/2+8} L 10,${t/2+8} Z" fill="#5a6b4a" stroke="#3a4b2a" stroke-width="1.5"/>\n            \x3c!-- Superstructure --\x3e\n            <rect x="${e/2-12}" y="${t/2-5}" width="24" height="10" rx="2" fill="#4a5b3a" stroke="#3a4b2a" stroke-width="1"/>\n            \x3c!-- Forward turret --\x3e\n            <circle cx="22" cy="${t/2}" r="5" fill="#4a5b3a" stroke="#3a4b2a" stroke-width="1"/>\n            <line x1="22" y1="${t/2}" x2="10" y2="${t/2}" stroke="#3a4b2a" stroke-width="2" stroke-linecap="round"/>\n            \x3c!-- Aft turret --\x3e\n            <circle cx="${e-22}" cy="${t/2}" r="4" fill="#4a5b3a" stroke="#3a4b2a" stroke-width="1"/>\n            <line x1="${e-22}" y1="${t/2}" x2="${e-12}" y2="${t/2}" stroke="#3a4b2a" stroke-width="1.5" stroke-linecap="round"/>\n            \x3c!-- Bow point --\x3e\n            <polygon points="4,${t/2} 10,${t/2-5} 10,${t/2+5}" fill="#5a6b4a"/>\n        </svg>`,Submarine:(e,t)=>`\n        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${e} ${t}" width="${e}" height="${t}">\n            \x3c!-- Hull - rounded --\x3e\n            <ellipse cx="${e/2}" cy="${t/2}" rx="${e/2-3}" ry="${t/2-6}" fill="#2a2a2a" stroke="#1a1a1a" stroke-width="1.5"/>\n            \x3c!-- Conning tower --\x3e\n            <rect x="${e/2-10}" y="${t/2-8}" width="20" height="16" rx="4" fill="#333" stroke="#1a1a1a" stroke-width="1"/>\n            \x3c!-- Periscope --\x3e\n            <line x1="${e/2+4}" y1="${t/2-8}" x2="${e/2+4}" y2="${t/2-14}" stroke="#444" stroke-width="2" stroke-linecap="round"/>\n            <circle cx="${e/2+4}" cy="${t/2-15}" r="2" fill="#555" stroke="#333" stroke-width="0.5"/>\n            \x3c!-- Bow --\x3e\n            <ellipse cx="8" cy="${t/2}" rx="5" ry="${t/2-8}" fill="#252525"/>\n            \x3c!-- Stern planes --\x3e\n            <line x1="${e-8}" y1="${t/2-10}" x2="${e-8}" y2="${t/2+10}" stroke="#333" stroke-width="2"/>\n            \x3c!-- Propeller hint --\x3e\n            <circle cx="${e-5}" cy="${t/2}" r="3" fill="none" stroke="#444" stroke-width="1"/>\n            \x3c!-- Hull details --\x3e\n            <line x1="18" y1="${t/2}" x2="${e/2-12}" y2="${t/2}" stroke="#333" stroke-width="0.8"/>\n            <line x1="${e/2+12}" y1="${t/2}" x2="${e-18}" y2="${t/2}" stroke="#333" stroke-width="0.8"/>\n        </svg>`,PatrolBoat:(e,t)=>`\n        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${e} ${t}" width="${e}" height="${t}">\n            \x3c!-- Hull - small and fast --\x3e\n            <path d="M 4,${t/2} L 8,${t/2-7} L ${e-6},${t/2-7} Q ${e-2},${t/2-3} ${e-2},${t/2} Q ${e-2},${t/2+3} ${e-6},${t/2+7} L 8,${t/2+7} Z" fill="#d4cfc4" stroke="#aaa48e" stroke-width="1.5"/>\n            \x3c!-- Cabin --\x3e\n            <rect x="${e/2-8}" y="${t/2-5}" width="16" height="10" rx="2" fill="#c4bfb4" stroke="#aaa48e" stroke-width="1"/>\n            \x3c!-- Small gun --\x3e\n            <circle cx="16" cy="${t/2}" r="3" fill="#b4afa4" stroke="#aaa48e" stroke-width="0.8"/>\n            <line x1="16" y1="${t/2}" x2="8" y2="${t/2}" stroke="#aaa48e" stroke-width="1.5" stroke-linecap="round"/>\n            \x3c!-- Bow --\x3e\n            <polygon points="4,${t/2} 8,${t/2-4} 8,${t/2+4}" fill="#d4cfc4"/>\n            \x3c!-- Wake lines --\x3e\n            <line x1="${e-4}" y1="${t/2-4}" x2="${e+2}" y2="${t/2-6}" stroke="#aaa48e" stroke-width="0.5" opacity="0.5"/>\n            <line x1="${e-4}" y1="${t/2+4}" x2="${e+2}" y2="${t/2+6}" stroke="#aaa48e" stroke-width="0.5" opacity="0.5"/>\n        </svg>`};function s(e,t,n){const r=i[e];return r?r(t*a,36):""}var o=n(878);const l=[{name:"Carrier",displayName:"Carrier",size:5},{name:"Battleship",displayName:"Battleship",size:4},{name:"Destroyer",displayName:"Destroyer",size:3},{name:"Submarine",displayName:"Submarine",size:3},{name:"PatrolBoat",displayName:"Patrol Boat",size:2}];function c(e){const t=document.createElement("div");t.className="score-panel";const n=document.createElement("h3");n.className="score-panel-title",n.textContent=e,t.appendChild(n);const r=document.createElement("ul");return r.className="score-panel-list",l.forEach((e=>{const t=document.createElement("li");t.className="score-ship",t.dataset.shipName=e.name;const n=document.createElement("div");n.className="score-ship-svg",n.style.width=25*e.size+"px",n.style.height="25px",n.innerHTML=s(e.name,e.size),t.appendChild(n);const a=document.createElement("span");a.className="score-ship-name",a.textContent=e.displayName,t.appendChild(a);const i=document.createElement("span");i.className="score-ship-status",t.appendChild(i),r.appendChild(t)})),t.appendChild(r),t}let d=null,u=!1;function h(e,t,n,r,i,o){const l=document.createElement("div");l.className="ship-overlay battle-ship-overlay",l.dataset.shipName=t;const c="X"===o?n:1,d="Y"===o?n:1;l.style.left=i*a+"px",l.style.top=r*a+"px",l.style.width=c*a+"px",l.style.height=d*a+"px";const u=document.createElement("div");u.className="ship-overlay-svg","Y"===o&&(u.classList.add("rotated"),u.style.width=n*a+"px",u.style.height="36px"),u.innerHTML=s(t,n),l.appendChild(u),e.appendChild(l)}function p(e){const t=document.getElementById(e);if(!t)return;const n=document.createElement("div");n.className="radar-sweep",t.appendChild(n)}function m(e){const t=e.target.closest(".field");if(!t||u)return;if("battle"!==d.phase||"player"!==d.game.currentTurn)return;const n=parseInt(t.dataset.row,10),r=parseInt(t.dataset.col,10);if(d.game.player.alreadyHit(n,r))return;const a=d.playerAttack(n,r);if(!a||"already"===a.result)return;if(u=!0,f(t,a),function(e){if(!e||"hit"!==e.result||!e.sunk)return;const t=document.querySelector("#content-right .score-panel");if(!t)return;const n=e.ship,r=t.querySelector(`[data-ship-name="${n.name}"]`);r&&(r.classList.add("score-sunk"),r.querySelector(".score-ship-status").textContent="â˜ ")}(a),"hit"===a.result&&a.sunk){const e=d.getSunkShipPositions(d.game.computerBoard).find((e=>e.name===a.ship.name));e&&function(e){const t=document.getElementById("field-container-computer");t&&(t.querySelector(`.ship-overlay[data-ship-name="${e.name}"]`)||h(t,e.name,e.size,e.row,e.col,e.orientation))}(e)}const i=d.checkGameOver();if(i)return w("player"===i?"Victory! You sank the entire enemy fleet!":"Defeat! Your fleet has been sunk!"),void $(i);"hit"===a.result&&a.sunk?w(`You sank their ${a.ship.name}!`):"hit"===a.result?w("Hit!"):w("Miss..."),(0,o.aD)(a).then((()=>{setTimeout((()=>function(){const e=d.computerTurn();if(!e)return void(u=!1);const t=document.getElementById("field-container-player");if(t){const n=t.querySelector(`.field[data-row="${e.row}"][data-col="${e.col}"]`);n&&f(n,e)}!function(e){const t=document.querySelector("#content-left .score-panel");t&&e.fleet.forEach((e=>{const n=t.querySelector(`[data-ship-name="${e.name}"]`);n&&e.isSunk()&&(n.classList.add("score-sunk"),n.querySelector(".score-ship-status").textContent="â˜ ")}))}(d.game.playerBoard);const n=d.checkGameOver();if(n)return w("player"===n?"Victory! You sank the entire enemy fleet!":"Defeat! Your fleet has been sunk!"),void $(n);"hit"===e.result&&e.sunk?w(`Enemy sank your ${e.ship.name}! Your turn.`):"hit"===e.result?w("Enemy hit your ship! Your turn."):w("Enemy missed. Your turn!"),(0,o.aD)(e).then((()=>{u=!1}))}()),500)}))}function f(e,t){"hit"===t.result?e.classList.add("cell-hit"):e.classList.add("cell-miss")}let y=null,g=null,x=null;function w(e){y&&clearInterval(y),g&&clearTimeout(g);const t=function(){let e=document.querySelector(".typewriter-zone");return e||(e=document.createElement("div"),e.className="typewriter-zone",document.body.appendChild(e)),e}();x&&x.remove();const n=document.createElement("div");n.className="typewriter-msg",n.textContent="",t.appendChild(n),x=n;let r=0;y=setInterval((()=>{n.textContent+=e[r],r++,r>=e.length&&(clearInterval(y),y=null,g=setTimeout((()=>{n.classList.add("fadeout"),g=setTimeout((()=>{n.remove(),x===n&&(x=null)}),600)}),2e3))}),40)}function $(e){u=!0,document.querySelectorAll(".radar-sweep").forEach((e=>{e.classList.add("radar-stopped")}));const t=document.createElement("div");t.className="gameover-overlay";const r=document.createElement("div");r.className="gameover-box";const a=document.createElement("h2");a.className="gameover-title",a.textContent="player"===e?"Victory!":"Defeat!";const i=document.createElement("p");i.className="gameover-subtitle",i.textContent="player"===e?"You destroyed the entire enemy fleet.":"Your fleet has been destroyed.";const s=function(e){const t=document.createElement("div");t.className="gameover-difficulty";const n=document.createElement("span");n.className="difficulty-label",n.textContent="Difficulty",t.appendChild(n);const r=document.createElement("div");return r.className="difficulty-options",["easy","medium","hard"].forEach((t=>{const n=document.createElement("label");n.className="difficulty-option";const a=document.createElement("input");a.type="radio",a.name="gameover-difficulty",a.value=t,t===e&&(a.checked=!0);const i=document.createElement("span");i.textContent=t.charAt(0).toUpperCase()+t.slice(1),n.appendChild(a),n.appendChild(i),r.appendChild(n)})),t.appendChild(r),t}(d.difficulty),o=document.createElement("button");o.className="setup-btn",o.textContent="Play Again",o.addEventListener("click",(async()=>{const e=r.querySelector('input[name="gameover-difficulty"]:checked');e&&d.setDifficulty(e.value),t.remove(),d.resetGame(),u=!1,document.getElementById("content-right").innerHTML="",(await Promise.resolve().then(n.bind(n,371))).default.init(d)})),r.appendChild(a),r.appendChild(i),r.appendChild(s),r.appendChild(o),t.appendChild(r),document.body.appendChild(t)}const k=function(e){d=e,function(){const e=document.getElementById("content-left");e.innerHTML="";const t=document.createElement("div");t.className="battle-section";const n=document.createElement("h2");n.className="board-title",n.textContent="Your Fleet",t.appendChild(n);const a=r.createMap("player");t.appendChild(a),t.appendChild(c("Your Fleet")),w("Your turn â€” fire at the enemy grid!"),e.appendChild(t),function(){const e=document.getElementById("field-container-player");e&&d.game.playerBoard.placements.forEach((t=>{h(e,t.ship.name,t.ship.size,t.row,t.col,t.orientation)}))}(),p("field-container-player");const i=document.getElementById("content-right");i.innerHTML="";const s=document.createElement("div");s.className="battle-section";const o=document.createElement("h2");o.className="board-title",o.textContent="Enemy Waters",s.appendChild(o);const l=r.createMap("computer");s.appendChild(l),s.appendChild(c("Enemy Fleet")),i.appendChild(s),p("field-container-computer"),function(){const e=document.getElementById("field-container-computer");e&&e.addEventListener("click",m)}()}()};let v=null,b=null;function E(e){const t=e.currentTarget;b={name:t.dataset.shipName,size:parseInt(t.dataset.shipSize,10)},t.classList.add("dragging"),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",t.dataset.shipName);const n=t.querySelector("svg");if(n){const t=n.cloneNode(!0);t.style.opacity="0.8";const r=document.createElement("div");r.style.position="absolute",r.style.top="-9999px",r.appendChild(t),document.body.appendChild(r),e.dataTransfer.setDragImage(r,0,0),setTimeout((()=>r.remove()),0)}}function C(e){e.currentTarget.classList.remove("dragging"),b=null,L()}function T(e){e.preventDefault(),e.dataTransfer.dropEffect="move";const t=e.target.closest(".field");if(!t||!b)return;L();const n=parseInt(t.dataset.row,10),r=parseInt(t.dataset.col,10),{size:a}=b,i=v.orientation,s=v.game.playerBoard.isPlacementPossible({size:a},n,r,i),o=B(n,r,a,i),l=s?"preview-valid":"preview-invalid";o.forEach((e=>{e&&e.classList.add(l)}))}function S(e){const t=document.getElementById("field-container-player");t&&!t.contains(e.relatedTarget)&&L()}function N(e){e.preventDefault(),L();const t=e.target.closest(".field");if(!t||!b)return;const n=parseInt(t.dataset.row,10),r=parseInt(t.dataset.col,10),{name:a,size:i}=b,s=v.orientation;v.placePlayerShip({name:a,size:i},n,r,s)?((0,o.Tk)(),P(a,i,n,r,s),M(a),A()):(0,o.i_)(),b=null}function B(e,t,n,r){const a=document.getElementById("field-container-player");if(!a)return[];const i=[];for(let s=0;s<n;s++){const n="Y"===r?e+s:e,o="X"===r?t+s:t,l=a.querySelector(`.field[data-row="${n}"][data-col="${o}"]`);i.push(l)}return i}function L(){const e=document.getElementById("field-container-player");e&&e.querySelectorAll(".preview-valid, .preview-invalid").forEach((e=>{e.classList.remove("preview-valid","preview-invalid")}))}function P(e,t,n,r,i){B(n,r,t,i).forEach(((t,n)=>{t&&(t.classList.add("ship-placed"),t.dataset.shipName=e)}));const o=document.getElementById("field-container-player");if(!o)return;const l=document.createElement("div");l.className="ship-overlay",l.dataset.shipName=e;const c="X"===i?t:1,d="Y"===i?t:1;l.style.left=r*a+"px",l.style.top=n*a+"px",l.style.width=c*a+"px",l.style.height=d*a+"px";const u=document.createElement("div");u.className="ship-overlay-svg","Y"===i&&(u.classList.add("rotated"),u.style.width=t*a+"px",u.style.height="36px"),u.innerHTML=s(e,t),l.appendChild(u),o.appendChild(l)}function M(e){const t=document.getElementById(`ship-${e}`);t&&(t.classList.add("placed"),t.draggable=!1)}function A(){const e=document.getElementById("start-btn");e&&(e.disabled=null!==v.getCurrentShipToPlace())}function H(){v.rotateOrientation();const e=v.orientation;document.querySelectorAll(".ship-item:not(.placed) .ship-svg-container").forEach((t=>{"Y"===e?t.classList.add("rotated"):t.classList.remove("rotated")}))}function z(){I(),v.getShipsToPlace().forEach((e=>{let t=!1;for(;!t;){const n=Math.floor(10*Math.random()),r=Math.floor(10*Math.random()),a=Math.random()<.5?"X":"Y";t=v.placePlayerShip(e,n,r,a),t&&(P(e.name,e.size,n,r,a),M(e.name))}})),(0,o.Tk)(),A()}function I(){v.resetPlacement();const e=document.getElementById("field-container-player");e&&(e.querySelectorAll(".ship-placed").forEach((e=>{e.classList.remove("ship-placed"),delete e.dataset.shipName})),e.querySelectorAll(".ship-overlay").forEach((e=>e.remove()))),v.getShipsToPlace().forEach((e=>function(e){const t=document.getElementById(`ship-${e}`);t&&(t.classList.remove("placed"),t.draggable=!0)}(e.name))),A()}function _(){v.startBattle()&&k(v)}const O={init:function(e){v=e,function(){const e=document.getElementById("content-left");e.innerHTML="";const t=document.createElement("div");t.className="setup-container";const n=document.createElement("div");n.className="grid-section";const a=document.createElement("h2");a.className="setup-title",a.textContent="Place Your Fleet",n.appendChild(a);const i=r.createMap("player");n.appendChild(i),t.appendChild(n);const o=function(){const e=document.createElement("div");e.className="dock";const t=document.createElement("h3");t.className="dock-title",t.textContent="Fleet Dock",e.appendChild(t);const n=document.createElement("div");return n.className="ship-list",n.id="ship-list",v.getShipsToPlace().forEach((e=>{const t=function(e){const t=document.createElement("div");t.className="ship-item",t.id=`ship-${e.name}`,t.dataset.shipName=e.name,t.dataset.shipSize=e.size,t.draggable=!0;const n=document.createElement("div");n.className="ship-svg-container",n.innerHTML=s(e.name,e.size,v.orientation),t.appendChild(n);const r=document.createElement("span");return r.className="ship-label",r.textContent=`${e.name} (${e.size})`,t.appendChild(r),t.addEventListener("dragstart",E),t.addEventListener("dragend",C),t}(e);n.appendChild(t)})),e.appendChild(n),e.appendChild(function(){const e=document.createElement("div");e.className="setup-buttons";const t=document.createElement("button");t.className="setup-btn",t.id="rotate-btn",t.textContent="Rotate",t.addEventListener("click",H);const n=document.createElement("button");n.className="setup-btn",n.id="random-btn",n.textContent="Random",n.addEventListener("click",z);const a=document.createElement("button");a.className="setup-btn",a.id="reset-btn",a.textContent="Reset",a.addEventListener("click",I);const i=document.createElement("button");return i.className="setup-btn start-btn",i.id="start-btn",i.textContent="Start Battle",i.disabled=!0,i.addEventListener("click",_),r.appendAll(e,[t,n,a,i]),e}()),e}();t.appendChild(o),e.appendChild(t),function(){const e=document.getElementById("field-container-player");e&&(e.addEventListener("dragover",T),e.addEventListener("dragleave",S),e.addEventListener("drop",N))}()}()}}},878:(e,t,n)=>{n.d(t,{Tk:()=>o,Zk:()=>s,aD:()=>d,i_:()=>l});let r=null,a=!1;function i(){return r||(r=new(window.AudioContext||window.webkitAudioContext)),r}function s(){return a=!a,a}function o(){if(a)return;const e=i(),t=e.createOscillator(),n=e.createGain();t.connect(n),n.connect(e.destination),t.type="sine",t.frequency.setValueAtTime(440,e.currentTime),t.frequency.exponentialRampToValueAtTime(880,e.currentTime+.1),n.gain.setValueAtTime(.15,e.currentTime),n.gain.exponentialRampToValueAtTime(.01,e.currentTime+.15),t.start(e.currentTime),t.stop(e.currentTime+.15)}function l(){if(a)return;const e=i(),t=e.createOscillator(),n=e.createGain();t.connect(n),n.connect(e.destination),t.type="square",t.frequency.setValueAtTime(150,e.currentTime),t.frequency.exponentialRampToValueAtTime(80,e.currentTime+.2),n.gain.setValueAtTime(.12,e.currentTime),n.gain.exponentialRampToValueAtTime(.01,e.currentTime+.25),t.start(e.currentTime),t.stop(e.currentTime+.25)}function c(e,t){a||e.then((e=>{const n=new Audio(e.default);n.volume=.5,n.playbackRate=t,n.play()}))}function d(e){return c(n.e(392).then(n.t.bind(n,392,17)),.9),new Promise((t=>{setTimeout((()=>{"hit"===e.result&&e.sunk?(c(n.e(704).then(n.t.bind(n,704,17)),.7),setTimeout((()=>{c(n.e(554).then(n.t.bind(n,554,17)),.6),setTimeout(t,400)}),300)):"hit"===e.result?(c(n.e(704).then(n.t.bind(n,704,17)),.7),setTimeout(t,400)):(c(n.e(850).then(n.t.bind(n,850,17)),1.1),setTimeout(t,300))}),500)}))}}},i={};function s(e){var t=i[e];if(void 0!==t)return t.exports;var n=i[e]={exports:{}};return a[e](n,n.exports,s),n.exports}s.m=a,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,s.t=function(n,r){if(1&r&&(n=this(n)),8&r)return n;if("object"==typeof n&&n){if(4&r&&n.__esModule)return n;if(16&r&&"function"==typeof n.then)return n}var a=Object.create(null);s.r(a);var i={};e=e||[null,t({}),t([]),t(t)];for(var o=2&r&&n;"object"==typeof o&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach((e=>i[e]=()=>n[e]));return i.default=()=>n,s.d(a,i),a},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,n)=>(s.f[n](e,t),t)),[])),s.u=e=>e+".main.js",s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n={},r="battleship:",s.l=(e,t,a,i)=>{if(n[e])n[e].push(t);else{var o,l;if(void 0!==a)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==e||u.getAttribute("data-webpack")==r+a){o=u;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,s.nc&&o.setAttribute("nonce",s.nc),o.setAttribute("data-webpack",r+a),o.src=e),n[e]=[t];var h=(t,r)=>{o.onerror=o.onload=null,clearTimeout(p);var a=n[e];if(delete n[e],o.parentNode&&o.parentNode.removeChild(o),a&&a.forEach((e=>e(r))),t)return t(r)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=h.bind(null,o.onerror),o.onload=h.bind(null,o.onload),l&&document.head.appendChild(o)}},s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=n[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e})(),(()=>{var e={792:0};s.f.j=(t,n)=>{var r=s.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var a=new Promise(((n,a)=>r=e[t]=[n,a]));n.push(r[2]=a);var i=s.p+s.u(t),o=new Error;s.l(i,(n=>{if(s.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var a=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.src;o.message="Loading chunk "+t+" failed.\n("+a+": "+i+")",o.name="ChunkLoadError",o.type=a,o.request=i,r[1](o)}}),"chunk-"+t,t)}};var t=(t,n)=>{var r,a,[i,o,l]=n,c=0;if(i.some((t=>0!==e[t]))){for(r in o)s.o(o,r)&&(s.m[r]=o[r]);l&&l(s)}for(t&&t(n);c<i.length;c++)a=i[c],s.o(e,a)&&e[a]&&e[a][0](),e[a]=0},n=self.webpackChunkbattleship=self.webpackChunkbattleship||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();const o=class{constructor(e){this.name=e,this.hitCoords=new Set}setName(e){this.name=e}attack(e,t,n){this.alreadyHit(e,t)||(this.hitCoords.add(`${e},${t}`),n.takeHit(e,t))}randomAttack(e){if(100===this.hitCoords.size)return;let t=Math.floor(10*Math.random()),n=Math.floor(10*Math.random());for(;this.alreadyHit(t,n);)t=Math.floor(10*Math.random()),n=Math.floor(10*Math.random());this.hitCoords.add(`${t},${n}`),e.takeHit(t,n)}alreadyHit(e,t){return this.hitCoords.has(`${e},${t}`)}},l=class{constructor(e,t){this.size=e,this.name=t,this.hits=0,this.sunk=!1}hit(){this.hits+=1,this.hits===this.size&&(this.sunk=!0)}isSunk(){return this.sunk}getName(){return this.name}getSize(){return this.size}},c=10,d=class{constructor(){this.board=new Array(c).fill("x").map((()=>new Array(c).fill("x"))),this.missedShots=new Array(c).fill(!1).map((()=>new Array(c).fill(!1))),this.placeMode="X",this.fleet=[],this.placements=[]}rotate(){"X"===this.placeMode?this.placeMode="Y":this.placeMode="X"}placeShip(e,t,n,r){if(!this.isPlacementPossible(e,t,n,r))return!1;if("Y"===r)for(let r=0;r<e.size;r++)this.board[t+r][n]=e;else for(let r=0;r<e.size;r++)this.board[t][n+r]=e;return this.fleet.push(e),this.placements.push({ship:e,row:t,col:n,orientation:r}),!0}placeShipsRandomly(){if(this.fleet.length>0)return;const e=[],t=new l(5,"Carrier"),n=new l(4,"Battleship"),r=new l(3,"Destroyer"),a=new l(3,"Submarine"),i=new l(2,"PatrolBoat");e.push(t,n,r,a,i);let s=0;for(;s<5;){const t=Math.floor(10*Math.random()),n=Math.floor(10*Math.random()),r="XY".split("")[Math.floor(2*Math.random())];this.placeShip(e[s],t,n,r)&&s++}}isPlacementPossible(e,t,n,r){if(t<0||t>9||n<0||n>9)return!1;if("X"===r){if(n+e.size>c)return!1}else if(t+e.size>c)return!1;if("Y"===r){for(let r=0;r<e.size;r++)if("x"!==this.board[t+r][n])return!1}else for(let r=0;r<e.size;r++)if("x"!==this.board[t][n+r])return!1;if("Y"===r){for(let r=0;r<e.size;r++)for(let e=-1;e<=1;e++)for(let a=-1;a<=1;a++)if(!(t+e+r<0||t+e+r>=c||n+a<0||n+a>=c)&&"x"!==this.board[t+e+r][n+a])return!1}else for(let r=0;r<e.size;r++)for(let e=-1;e<=1;e++)for(let a=-1;a<=1;a++)if(!(t+e<0||t+e>=c||n+a+r<0||n+a+r>=c)&&"x"!==this.board[t+e][n+a+r])return!1;return!0}takeHit(e,t){if(e<0||e>=c||t<0||t>=c)return{result:"miss"};const n=this.board[e][t];return"hit"===n||"miss"===n?{result:"already"}:"x"!==n?(n.hit(),this.board[e][t]="hit",{result:"hit",ship:n,sunk:n.isSunk()}):(this.board[e][t]="miss",this.missedShots[e][t]=!0,{result:"miss"})}checkSunk(){for(let e=0;e<this.fleet.length;e++)if(!0===this.fleet[e].sunk)return!0;return!1}isGameOver(){if(0===this.fleet.length)return!1;for(let e=0;e<this.fleet.length;e++)if(!this.fleet[e].isSunk())return!1;return!0}isEmpty(){for(let e=0;e<c;e++)for(let t=0;t<c;t++)if("x"!==this.board[e][t])return!1;return!0}getFreeCells(){let e=100;for(let t=0;t<c;t++)for(let n=0;n<c;n++)"x"!==this.board[t][n]&&(e-=1);return e}},u=class{constructor(){this.player=new o("Captain"),this.computer=new o("computer"),this.playerBoard=new d,this.computerBoard=new d,this.currentTurn="player",this.gamePhase="setup"}getPlayer(){return this.player}getComputer(){return this.computer}setPlayerName(e="Captain"){this.getPlayer().setName(e)}switchTurn(){this.currentTurn="player"===this.currentTurn?"computer":"player"}reset(){this.player=new o("Captain"),this.computer=new o("computer"),this.playerBoard=new d,this.computerBoard=new d,this.currentTurn="player",this.gamePhase="setup"}},h=class{constructor(e="medium"){this.difficulty=e,this.reset()}reset(){this.mode="search",this.huntQueue=[],this.huntHits=[],this.huntDirection=null,this.attacked=new Set,this._searchOrder=null}getNextMove(){if("easy"!==this.difficulty&&"hunt"===this.mode){if(this.huntQueue=this.huntQueue.filter((e=>!this._alreadyAttacked(e.row,e.col))),this.huntQueue.length>0)return{...this.huntQueue[0]};this._clearHunt()}return this._searchMove()}recordResult(e,t,n){this.attacked.add(this._key(e,t)),"easy"!==this.difficulty&&"miss"!==n.result&&"hit"===n.result&&(n.sunk?this._clearHunt():(this.huntHits.push({row:e,col:t}),1===this.huntHits.length?(this.mode="hunt",this._addNeighbors(e,t)):this._rebuildHuntQueue()))}_key(e,t){return`${e},${t}`}_alreadyAttacked(e,t){return this.attacked.has(this._key(e,t))}_clearHunt(){this.mode="search",this.huntQueue=[],this.huntHits=[],this.huntDirection=null}_addNeighbors(e,t){const n=[{row:e-1,col:t},{row:e+1,col:t},{row:e,col:t-1},{row:e,col:t+1}].filter((e=>e.row>=0&&e.row<10&&e.col>=0&&e.col<10&&!this._alreadyAttacked(e.row,e.col)));this.huntQueue.push(...n)}_rebuildHuntQueue(){if(!(this.huntHits.length<2)){if(null===this.huntDirection){const e=this.huntHits[0],t=this.huntHits[1];this.huntDirection=e.row===t.row?"H":"V"}if(this.huntQueue=[],"H"===this.huntDirection){const e=this.huntHits[0].row,t=this.huntHits.map((e=>e.col)).sort(((e,t)=>e-t)),n=t[0],r=t[t.length-1];n>0&&!this._alreadyAttacked(e,n-1)&&this.huntQueue.push({row:e,col:n-1}),r<9&&!this._alreadyAttacked(e,r+1)&&this.huntQueue.push({row:e,col:r+1})}else{const e=this.huntHits[0].col,t=this.huntHits.map((e=>e.row)).sort(((e,t)=>e-t)),n=t[0],r=t[t.length-1];n>0&&!this._alreadyAttacked(n-1,e)&&this.huntQueue.push({row:n-1,col:e}),r<9&&!this._alreadyAttacked(r+1,e)&&this.huntQueue.push({row:r+1,col:e})}}}_buildSearchOrder(){const e=[];for(let t=0;t<10;t++)for(let n=0;n<10;n++)e.push({row:t,col:n});if("hard"===this.difficulty){const t=4.5,n=(e,n)=>Math.abs(e-t)+Math.abs(n-t),r=e.filter((e=>(e.row+e.col)%2==0)),a=e.filter((e=>(e.row+e.col)%2!=0)),i=e=>{const t={};e.forEach((e=>{const r=Math.round(n(e.row,e.col));t[r]||(t[r]=[]),t[r].push(e)}));const r=[];return Object.keys(t).map(Number).sort(((e,t)=>e-t)).forEach((e=>{const n=t[e];for(let e=n.length-1;e>0;e--){const t=Math.floor(Math.random()*(e+1));[n[e],n[t]]=[n[t],n[e]]}r.push(...n)})),r};this._searchOrder=[...i(r),...i(a)]}else{for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}this._searchOrder=e}}_searchMove(){this._searchOrder||this._buildSearchOrder();for(const e of this._searchOrder)if(!this._alreadyAttacked(e.row,e.col))return{row:e.row,col:e.col};return null}},p=[{name:"Carrier",size:5},{name:"Battleship",size:4},{name:"Destroyer",size:3},{name:"Submarine",size:3},{name:"PatrolBoat",size:2}];var m=s(371);const f=new class{constructor(){this.game=new u,this.phase="setup",this.orientation="X",this.placedShipsCount=0,this.difficulty="medium",this.ai=new h(this.difficulty)}setDifficulty(e){this.difficulty=e,this.ai=new h(e)}getShipsToPlace(){return p.map((e=>({...e})))}getCurrentShipToPlace(){return this.placedShipsCount>=p.length?null:{...p[this.placedShipsCount]}}rotateOrientation(){return this.orientation="X"===this.orientation?"Y":"X",this.orientation}placePlayerShip(e,t,n,r){if("setup"!==this.phase)return!1;const a=new l(e.size,e.name),i=this.game.playerBoard.placeShip(a,t,n,r);return i&&this.placedShipsCount++,i}placeComputerShips(){this.game.computerBoard.placeShipsRandomly()}startBattle(){return!(this.placedShipsCount<p.length||(this.placeComputerShips(),this.phase="battle",this.game.gamePhase="battle",this.game.currentTurn="player",0))}resetPlacement(){this.game.playerBoard=new this.game.playerBoard.constructor,this.placedShipsCount=0,this.orientation="X"}playerAttack(e,t){if("battle"!==this.phase||"player"!==this.game.currentTurn)return null;if(this.game.player.alreadyHit(e,t))return{result:"already"};this.game.player.hitCoords.add(`${e},${t}`);const n=this.game.computerBoard.takeHit(e,t);return this.game.switchTurn(),n}computerTurn(){if("battle"!==this.phase||"computer"!==this.game.currentTurn)return null;const{row:e,col:t}=this.ai.getNextMove();this.game.computer.hitCoords.add(`${e},${t}`);const n=this.game.playerBoard.takeHit(e,t);return this.ai.recordResult(e,t,n),this.game.switchTurn(),{row:e,col:t,...n}}getSunkShipPositions(e){return e.placements.filter((e=>e.ship.isSunk())).map((e=>({name:e.ship.name,size:e.ship.size,row:e.row,col:e.col,orientation:e.orientation})))}checkGameOver(){return this.game.computerBoard.isGameOver()?"player":this.game.playerBoard.isGameOver()?"computer":null}resetGame(){this.game.reset(),this.phase="setup",this.orientation="X",this.placedShipsCount=0,this.ai.reset()}};var y=s(878);const g=new class{constructor(){this.audio=null,this.muted=!1}async background(){const e=await s.e(527).then(s.t.bind(s,527,17));this.audio=new Audio(e.default),this.audio.loop=!0,this.audio.play()}BackgroundOnClick(){document.addEventListener("click",(()=>this.background()),{once:!0})}toggle(){if(this.audio)return this.muted=!this.muted,this.audio.muted=this.muted,this.muted}isMuted(){return this.muted}},x=new class{constructor(){}initPlayButton(){document.getElementById("play-button").addEventListener("click",(e=>{e.preventDefault(),this.onPlay()})),document.getElementById("name").addEventListener("keydown",(e=>{"Enter"===e.key&&(e.preventDefault(),this.onPlay())}))}onPlay(){const e=document.getElementById("name").value.toString().trim();e&&f.game.setPlayerName(`Captain ${e}`);const t=document.querySelector('input[name="difficulty"]:checked');t&&f.setDifficulty(t.value),document.getElementById("welcome-screen").classList.add("hidden"),m.default.init(f)}};g.BackgroundOnClick(),x.initPlayButton(),function(){const e=document.createElement("button");e.id="mute-btn",e.className="mute-btn",e.title="Toggle music",e.textContent="ðŸ”Š",e.addEventListener("click",(t=>{t.stopPropagation();const n=g.toggle();e.textContent=n?"ðŸ”‡":"ðŸ”Š"})),document.body.appendChild(e)}(),function(){const e=document.createElement("button");e.id="sfx-btn",e.className="mute-btn mute-btn--sfx",e.title="Toggle sound effects",e.textContent="ðŸ””",e.addEventListener("click",(t=>{t.stopPropagation();const n=(0,y.Zk)();e.textContent=n?"ðŸ”•":"ðŸ””"})),document.body.appendChild(e)}()})();